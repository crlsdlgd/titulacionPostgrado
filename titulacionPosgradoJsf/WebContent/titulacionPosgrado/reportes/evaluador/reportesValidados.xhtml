<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"> 
      

<ui:composition template="/componentesGenerales/plantillas/pltPrincipalSinMenu.xhtml">
<ui:define name="paginacion">
		<ui:include src="/componentesGenerales/plantillas/pltPaginacion.xhtml">
			<ui:param name="pagina"
				value=" Reportes / Listar validados " />
		</ui:include>
</ui:define>
<ui:define name="cuerpo">
	<script language="JavaScript">
		function start() {
		    PF('startButton1').disable();
		 
		    window['progress'] = setInterval(function() {
		        var pbClient = PF('pbClient'),
		        oldValue = pbClient.getValue(),
		        newValue = oldValue + 10;
		 
		        pbClient.setValue(pbClient.getValue() + 10);
		 
		        if(newValue === 100) {
		            clearInterval(window['progress']);
		        }
		    }, 1000);
		}
		function cancel() {
		    clearInterval(window['progress']);
		    PF('pbClient').setValue(0);
		    PF('startButton1').enable();
		}
</script>
<script language="JavaScript">
//<![CDATA[
	function abrirVentaReporte(formato, nombreReporte, tipo){
		var url = "/aplicacion/reportes";
		url = url + "?nombreJasper=" + nombreReporte;
		url = url + "&formato=" + formato;
		url = url + "&tipo=" + tipo;
		if(formato == 'vista'){
			var reportWindow = window.open(url, "reportWindow","menubar=0,resizable=0,status=0,width=800,height=600");
		}else{
			var reportWindow = window.open(url, "reportWindow","menubar=0,resizable=0,status=0,width=0,height=0");
		}
    } 
 //]]> 
</script>

	<h:form id="frmPstEstudiante" enctype="multipart/form-data" acceptcharset="UTF-8">
		<p:panel id="pnlBusqueda" header="Ingrese los datos para buscar" >
			<!-- ******************** TABLA RESPONSIVA ************************ -->
			<div class="grid condensed">
				<!-- ******************** FILA NUMERO 1 ************************ -->
		       	<div class="row cells111">
		     		<div class="cell colspan12" >
		       			<ui:decorate  template="/componentesGenerales/plantillas/pltComponenteEditSearchFcl.xhtml">
		       				<ui:define name="etiqueta">	
		       					<p:outputLabel id="lblConvocatoria" for="slcConvocatoria" value="Convocatoria: "/>	
		       				</ui:define>
		       				<ui:define name="valor">	
		       					<h:selectOneMenu id="slcConvocatoria" value="#{reportesForm.convocatoriaReporteEstado.cnvId}"
		       					required="true" requiredMessage="#{generalesConstantesForm.msgCampoRequerido}">
		       							<f:selectItem itemLabel="#{generalesConstantesForm.appSeleccione}" />
										<f:selectItems value="#{reportesForm.rfListConvocatorias}" var="item" itemLabel="#{item.cnvDescripcion}" itemValue="#{item.cnvId}" />
										<p:ajax listener="#{reportesForm.cambiarConvocatoria()}" update=" dtsPstEstudiante, btnGenerar, msgConvocatoria, slcConvocatoria, lblConvocatoria"/>
								</h:selectOneMenu>
		       				</ui:define>
		       				<ui:define name="etiquetaError" >
								<p:message id="msgConvocatoria" for="slcConvocatoria"  />
							</ui:define>
		       			</ui:decorate>
		       		</div>
		       	</div>
		       		<!-- ******************** FILA NUMERO 2 ************************ -->
		       	<div class="row cells111">	
		       		<div class="cell colspan12" >
		       			<ui:decorate  template="/componentesGenerales/plantillas/pltComponenteEditSearchFcl.xhtml">
		       				<ui:define name="etiqueta">	
		       					<p:outputLabel id="lblCarrera" for="slcCarrera" value="Programa: "/>
		       				</ui:define>
		       				<ui:define name="valor">	
								<h:selectOneMenu id="slcCarrera" value="#{reportesForm.carreraReporteEstado.crrId}" 
								required="true" requiredMessage="#{generalesConstantesForm.msgCampoRequerido}">
		       							<f:selectItem itemLabel="#{generalesConstantesForm.appSeleccione}" />
										<f:selectItems value="#{reportesForm.rfListCarreras}" var="item" itemLabel="#{item.crrDescripcion}" 
										itemValue="#{item.crrId}" />
										<p:ajax listener="#{reportesForm.cambiarFacultad()}" 
										update=" dtsPstEstudiante, btnGenerar, btnExportar msgCarrera , slcCarrera lblCarrera"/>
								</h:selectOneMenu>	
		       				</ui:define>
		       				<ui:define name="etiquetaError">
								<p:message id="msgCarrera" for="slcCarrera"  />
							</ui:define>
		       			</ui:decorate>
		        	</div>
		    	</div>
		    	<!-- ******************** FILA NUMERO 3 ************************ -->
			       	<div class="row cells111">
			       		<div class="cell colspan12" >
			       			<ui:decorate  template="/componentesGenerales/plantillas/pltComponenteEditSearchFcl.xhtml">
			       				<ui:define name="etiqueta">	
			       					<p:outputLabel id="lblIdentificacion" for="txtIdentificacion" value="Identificación: "/>	
			       				</ui:define>
			       				<ui:define name="valor">	
			       					<p:inputText id="txtIdentificacion" value="#{reportesForm.frmRfCedulaPostulante}" >
			       					</p:inputText>	
			       				</ui:define>
			       				<ui:define name="etiquetaError">	
			       					<p:message id="msgIdentificacion" for="txtIdentificacion"/>	
			       				</ui:define>
			       			</ui:decorate>
			       		</div>
			       	</div>
		   	</div> 	
		</p:panel>
		<div >
		<p:commandButton id="btnGenerar" value="Generar" action="#{reportesForm.generarDatosReporteEstados(reportesForm.convocatoriaReporteEstado.cnvId,reportesForm.facultadReporteEstado.fclId)}" 
		update="dtsPstEstudiante , btnGenerar,btnExportar , msgCarrerra , msgConvocatoria " disabled="#{reportesForm.refDeshabilitado}" 
					onclick="PF('dialogoTrabajando').show();"
					oncomplete="PF('dialogoTrabajando').hide();" ajax="false" inmediate="true">
		</p:commandButton>	
		<p:commandButton id="btnExportar" value="Exportar a excel" action="#{reportesForm.irInicio}" disabled="#{reportesForm.refDeshabilitadoExportar}"  >
    				<p:ajax oncomplete="abrirVentaReporte('XLS','ReporteEstadosPostulantes','ESTADOS');" />
    	</p:commandButton>
    	<p:commandButton id="btnLimpiar" value="Limpiar" action="#{reportesForm.limpiar()}" 
    			update=" dtsPstEstudiante, btnGenerar, btnExportar,txtIdentificacion,slcCarrera,slcConvocatoria">
    	</p:commandButton>
		</div>
	<p:panel id="pnlResultados" header="Resultados de la búsqueda " >
			<p:dataTable id="dtsPstEstudiante" var="item" value="#{reportesForm.frmRfListaEstadosPostulantes}"
		    		 		rows="10" paginator="true"
		                         paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
		                         rowsPerPageTemplate="5,10" emptyMessage="NO SE ENCONTRARON DATOS CON LOS PARÁMETROS DE BÚSQUEDA INGRESADOS">
 						<p:column headerText="Convocatoria" style="width: 6em ! important;">
				            <h:outputText value="#{item.cnvDescripcion}"/>
				        </p:column>
				        <p:column headerText="Facultad" style="width: 7em ! important;">
				            <h:outputText value="#{item.fclDescripcion}" />
				        </p:column>
				        <p:column headerText="Programa" style="width: 7em ! important;">
				            <h:outputText value="#{item.crrDescripcion}" />
				        </p:column>
				        <p:column headerText="Identificación" style="width: 7em ! important;">
				            <h:outputText value="#{item.prsIdentificacion}" />
				        </p:column>
				        <p:column headerText="Apellidos" style="width: 10em ! important;">
				            <h:outputText value="#{item.prsPrimerApellido} #{item.prsSegundoApellido}"/>
				        </p:column>
				        <p:column headerText="Nombres" style="width: 8em ! important;">
				            <h:outputText value="#{item.prsNombres}"/>
				        </p:column>
				        <p:column headerText="Registro Senescyt" style="width: 8em ! important;">
				            <h:outputText value="#{item.fcesRegTtlSenecyt}"/>
				        </p:column>
				        <p:column headerText="Estado" style="width: 5em ! important;">
				            <h:outputText value="#{generalesConstantesForm.getEstadoEstudiante(item.trttEstadoProceso)}"/>
				        </p:column>
			</p:dataTable>
		</p:panel>
		<div >
		<p:commandButton id="btnRegresar" action="#{reportesForm.irInicio()}" value="Regresar" immediate="true"/>
		</div>

	</h:form>		
</ui:define>
</ui:composition>
</html>